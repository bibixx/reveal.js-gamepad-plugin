{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/gamepad.js"],"names":[],"mappings":"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","file":"gamepad.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","( () => {\n  const haveEvents = \"ongamepadconnected\" in window;\n  const controllers = {};\n  let cooldownedButtons = [];\n\n  const BUTTON = {\n    A: 0,\n    B: 1,\n    X: 2,\n    Y: 3,\n    LB: 4,\n    RB: 5,\n    LT: 6,\n    RT: 7,\n    BACK: 8,\n    START: 9,\n    LEFTSTICK: 10,\n    RIGHTSTICK: 11,\n    DUP: 12,\n    DDOWN: 13,\n    DLEFT: 14,\n    DRIGHT: 15,\n  };\n\n  const AXIS = {\n    LOX: 0,\n    LOY: 1,\n    ROX: 2,\n    ROY: 3,\n  };\n\n  let pointing = false;\n  const pointer = document.createElement( \"div\" );\n  pointer.style.position = \"absolute\";\n  pointer.style.width = \"1px\";\n  pointer.style.height = \"1px\";\n  pointer.style.boxShadow = \"0 0 7px 4px #f00\";\n  pointer.style.background = \"#f00\";\n  pointer.style.top = 0;\n  pointer.style.left = 0;\n  pointer.style.zIndex = 99;\n  pointer.style.borderRadius = \"50%\";\n  pointer.style.display = \"none\";\n  document.body.appendChild( pointer );\n\n  function cooldown( b ) {\n    if ( cooldownedButtons.indexOf( b ) < 0 ) {\n      cooldownedButtons.push( b );\n\n      setTimeout( () => {\n        cooldownedButtons = cooldownedButtons.filter( ( v ) => { return ( v !== b ); } );\n      }, 500 );\n\n      return true;\n    }\n\n    return false;\n  }\n\n  function addgamepad( gamepad ) {\n    controllers[gamepad.index] = gamepad;\n\n    requestAnimationFrame( updateStatus ); // eslint-disable-line\n  }\n\n  function scangamepads() {\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : ( navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : [] ); // eslint-disable-line no-nested-ternary\n    for ( let i = 0; i < gamepads.length; i++ ) {\n      if ( gamepads[i] ) {\n        if ( gamepads[i].index in controllers ) {\n          controllers[gamepads[i].index] = gamepads[i];\n        } else {\n          addgamepad( gamepads[i] );\n        }\n      }\n    }\n  }\n\n  function updateStatus() {\n    let i = 0;\n    let j;\n\n    if ( !haveEvents ) {\n      scangamepads();\n    }\n\n    for ( j in controllers ) {\n      if ( Object.prototype.hasOwnProperty.call( controllers, j ) ) {\n        const controller = controllers[j];\n\n        for ( i = 0; i < controller.buttons.length; i++ ) {\n          const val = controller.buttons[i];\n          let pressed;\n\n          if ( typeof ( val ) === \"object\" ) {\n            pressed = val.pressed;\n          }\n\n          if ( pressed && cooldown( `button-${i}` ) ) {\n            switch ( i ) {\n              case BUTTON.A:\n                if ( Reveal.isOverview() ) {\n                  Reveal.toggleOverview();\n                } else {\n                  Reveal.next();\n                }\n                break;\n              case BUTTON.B:\n                Reveal.prev();\n                break;\n              case BUTTON.LB:\n                Reveal.prev();\n                break;\n              case BUTTON.RB:\n                Reveal.next();\n                break;\n              case BUTTON.LT:\n                Reveal.left();\n                break;\n              case BUTTON.RT:\n                Reveal.right();\n                break;\n              case BUTTON.BACK:\n                Reveal.togglePause();\n                break;\n              case BUTTON.START:\n                Reveal.toggleOverview();\n                break;\n              case BUTTON.DUP:\n                Reveal.up();\n                break;\n              case BUTTON.DDOWN:\n                Reveal.down();\n                break;\n              case BUTTON.DLEFT:\n                Reveal.left();\n                break;\n              case BUTTON.DRIGHT:\n                Reveal.right();\n                break;\n              case BUTTON.RIGHTSTICK:\n                pointing = !pointing;\n                pointer.style.display = pointing ? \"block\" : \"none\";\n                break;\n              default:\n                console.log( i );\n            }\n          }\n        }\n\n        for ( i = 0; i < controller.axes.length; i++ ) {\n          const val = controller.axes[i];\n\n          if ( Math.abs( val ) > 0.85 && !pointing ) {\n            if ( cooldown( `axis-${i}` ) ) {\n              switch ( i ) {\n                case AXIS.LOX: {\n                  if ( val < 0 ) {\n                    Reveal.left();\n                  } else {\n                    Reveal.right();\n                  }\n                  break;\n                }\n                case AXIS.LOY: {\n                  if ( val < 0 ) {\n                    Reveal.up();\n                  } else {\n                    Reveal.down();\n                  }\n                  break;\n                }\n\n                // no default\n              }\n            }\n          }\n\n          if ( Math.abs( val ) > 0.2 && pointing ) {\n            const fastMultiplier = 8;\n            const left = pointer.style.left.replace( \"px\", \"\" ) * 1;\n            const top = pointer.style.top.replace( \"px\", \"\" ) * 1;\n            const constrainValue = ( newVal ) => { return Math.min( Math.max( newVal, 0 ), window.innerWidth ); };\n            switch ( i ) {\n              case AXIS.ROX: {\n                const newVal = ( val * 2 ) + left;\n                pointer.style.left = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.ROY: {\n                const newVal = ( val * 2 ) + top;\n                pointer.style.top = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.LOX: {\n                const newVal = ( val * fastMultiplier ) + left;\n                pointer.style.left = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.LOY: {\n                const newVal = ( val * fastMultiplier ) + top;\n                pointer.style.top = `${constrainValue( newVal )}px`;\n                break;\n              }\n\n              // no default\n            }\n          }\n        }\n      }\n    }\n\n    requestAnimationFrame( updateStatus );\n  }\n\n  function connecthandler( e ) {\n    addgamepad( e.gamepad );\n  }\n\n  function removegamepad( gamepad ) {\n    delete controllers[gamepad.index];\n  }\n\n  function disconnecthandler( e ) {\n    removegamepad( e.gamepad );\n  }\n\n  window.addEventListener( \"gamepadconnected\", connecthandler );\n  window.addEventListener( \"gamepaddisconnected\", disconnecthandler );\n\n  if ( !haveEvents ) {\n    setInterval( scangamepads, 500 );\n  }\n} )();\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZ2FtZXBhZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7QUNBQSxDQUFFLFlBQU07QUFDTixNQUFNLGFBQWEsd0JBQXdCLE1BQTNDO0FBQ0EsTUFBTSxjQUFjLEVBQXBCO0FBQ0EsTUFBSSxvQkFBb0IsRUFBeEI7O0FBRUEsTUFBTSxTQUFTO0FBQ2IsT0FBRyxDQURVO0FBRWIsT0FBRyxDQUZVO0FBR2IsT0FBRyxDQUhVO0FBSWIsT0FBRyxDQUpVO0FBS2IsUUFBSSxDQUxTO0FBTWIsUUFBSSxDQU5TO0FBT2IsUUFBSSxDQVBTO0FBUWIsUUFBSSxDQVJTO0FBU2IsVUFBTSxDQVRPO0FBVWIsV0FBTyxDQVZNO0FBV2IsZUFBVyxFQVhFO0FBWWIsZ0JBQVksRUFaQztBQWFiLFNBQUssRUFiUTtBQWNiLFdBQU8sRUFkTTtBQWViLFdBQU8sRUFmTTtBQWdCYixZQUFRO0FBaEJLLEdBQWY7O0FBbUJBLE1BQU0sT0FBTztBQUNYLFNBQUssQ0FETTtBQUVYLFNBQUssQ0FGTTtBQUdYLFNBQUssQ0FITTtBQUlYLFNBQUs7QUFKTSxHQUFiOztBQU9BLE1BQUksV0FBVyxLQUFmO0FBQ0EsTUFBTSxVQUFVLFNBQVMsYUFBVCxDQUF3QixLQUF4QixDQUFoQjtBQUNBLFVBQVEsS0FBUixDQUFjLFFBQWQsR0FBeUIsVUFBekI7QUFDQSxVQUFRLEtBQVIsQ0FBYyxLQUFkLEdBQXNCLEtBQXRCO0FBQ0EsVUFBUSxLQUFSLENBQWMsTUFBZCxHQUF1QixLQUF2QjtBQUNBLFVBQVEsS0FBUixDQUFjLFNBQWQsR0FBMEIsa0JBQTFCO0FBQ0EsVUFBUSxLQUFSLENBQWMsVUFBZCxHQUEyQixNQUEzQjtBQUNBLFVBQVEsS0FBUixDQUFjLEdBQWQsR0FBb0IsQ0FBcEI7QUFDQSxVQUFRLEtBQVIsQ0FBYyxJQUFkLEdBQXFCLENBQXJCO0FBQ0EsVUFBUSxLQUFSLENBQWMsTUFBZCxHQUF1QixFQUF2QjtBQUNBLFVBQVEsS0FBUixDQUFjLFlBQWQsR0FBNkIsS0FBN0I7QUFDQSxVQUFRLEtBQVIsQ0FBYyxPQUFkLEdBQXdCLE1BQXhCO0FBQ0EsV0FBUyxJQUFULENBQWMsV0FBZCxDQUEyQixPQUEzQjs7QUFFQSxXQUFTLFFBQVQsQ0FBbUIsQ0FBbkIsRUFBdUI7QUFDckIsUUFBSyxrQkFBa0IsT0FBbEIsQ0FBMkIsQ0FBM0IsSUFBaUMsQ0FBdEMsRUFBMEM7QUFDeEMsd0JBQWtCLElBQWxCLENBQXdCLENBQXhCOztBQUVBLGlCQUFZLFlBQU07QUFDaEIsNEJBQW9CLGtCQUFrQixNQUFsQixDQUEwQixVQUFFLENBQUYsRUFBUztBQUFFLGlCQUFTLE1BQU0sQ0FBZjtBQUFxQixTQUExRCxDQUFwQjtBQUNELE9BRkQsRUFFRyxHQUZIOztBQUlBLGFBQU8sSUFBUDtBQUNEOztBQUVELFdBQU8sS0FBUDtBQUNEOztBQUVELFdBQVMsVUFBVCxDQUFxQixPQUFyQixFQUErQjtBQUM3QixnQkFBWSxRQUFRLEtBQXBCLElBQTZCLE9BQTdCOztBQUVBLDBCQUF1QixZQUF2QixFQUg2QixDQUdVO0FBQ3hDOztBQUVELFdBQVMsWUFBVCxHQUF3QjtBQUN0QixRQUFNLFdBQVcsVUFBVSxXQUFWLEdBQXdCLFVBQVUsV0FBVixFQUF4QixHQUFvRCxVQUFVLGlCQUFWLEdBQThCLFVBQVUsaUJBQVYsRUFBOUIsR0FBOEQsRUFBbkksQ0FEc0IsQ0FDbUg7QUFDekksU0FBTSxJQUFJLElBQUksQ0FBZCxFQUFpQixJQUFJLFNBQVMsTUFBOUIsRUFBc0MsR0FBdEMsRUFBNEM7QUFDMUMsVUFBSyxTQUFTLENBQVQsQ0FBTCxFQUFtQjtBQUNqQixZQUFLLFNBQVMsQ0FBVCxFQUFZLEtBQVosSUFBcUIsV0FBMUIsRUFBd0M7QUFDdEMsc0JBQVksU0FBUyxDQUFULEVBQVksS0FBeEIsSUFBaUMsU0FBUyxDQUFULENBQWpDO0FBQ0QsU0FGRCxNQUVPO0FBQ0wscUJBQVksU0FBUyxDQUFULENBQVo7QUFDRDtBQUNGO0FBQ0Y7QUFDRjs7QUFFRCxXQUFTLFlBQVQsR0FBd0I7QUFDdEIsUUFBSSxJQUFJLENBQVI7QUFDQSxRQUFJLFVBQUo7O0FBRUEsUUFBSyxDQUFDLFVBQU4sRUFBbUI7QUFDakI7QUFDRDs7QUFFRCxTQUFNLENBQU4sSUFBVyxXQUFYLEVBQXlCO0FBQ3ZCLFVBQUssT0FBTyxTQUFQLENBQWlCLGNBQWpCLENBQWdDLElBQWhDLENBQXNDLFdBQXRDLEVBQW1ELENBQW5ELENBQUwsRUFBOEQ7QUFDNUQsWUFBTSxhQUFhLFlBQVksQ0FBWixDQUFuQjs7QUFFQSxhQUFNLElBQUksQ0FBVixFQUFhLElBQUksV0FBVyxPQUFYLENBQW1CLE1BQXBDLEVBQTRDLEdBQTVDLEVBQWtEO0FBQ2hELGNBQU0sTUFBTSxXQUFXLE9BQVgsQ0FBbUIsQ0FBbkIsQ0FBWjtBQUNBLGNBQUksZ0JBQUo7O0FBRUEsY0FBSyxRQUFTLEdBQVQseUNBQVMsR0FBVCxPQUFtQixRQUF4QixFQUFtQztBQUNqQyxzQkFBVSxJQUFJLE9BQWQ7QUFDRDs7QUFFRCxjQUFLLFdBQVcscUJBQW9CLENBQXBCLENBQWhCLEVBQTRDO0FBQzFDLG9CQUFTLENBQVQ7QUFDRSxtQkFBSyxPQUFPLENBQVo7QUFDRSxvQkFBSyxPQUFPLFVBQVAsRUFBTCxFQUEyQjtBQUN6Qix5QkFBTyxjQUFQO0FBQ0QsaUJBRkQsTUFFTztBQUNMLHlCQUFPLElBQVA7QUFDRDtBQUNEO0FBQ0YsbUJBQUssT0FBTyxDQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxFQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxFQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxFQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxFQUFaO0FBQ0UsdUJBQU8sS0FBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxJQUFaO0FBQ0UsdUJBQU8sV0FBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxLQUFaO0FBQ0UsdUJBQU8sY0FBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxHQUFaO0FBQ0UsdUJBQU8sRUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxLQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxLQUFaO0FBQ0UsdUJBQU8sSUFBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxNQUFaO0FBQ0UsdUJBQU8sS0FBUDtBQUNBO0FBQ0YsbUJBQUssT0FBTyxVQUFaO0FBQ0UsMkJBQVcsQ0FBQyxRQUFaO0FBQ0Esd0JBQVEsS0FBUixDQUFjLE9BQWQsR0FBd0IsV0FBVyxPQUFYLEdBQXFCLE1BQTdDO0FBQ0E7QUFDRjtBQUNFLHdCQUFRLEdBQVIsQ0FBYSxDQUFiO0FBOUNKO0FBZ0REO0FBQ0Y7O0FBRUQsYUFBTSxJQUFJLENBQVYsRUFBYSxJQUFJLFdBQVcsSUFBWCxDQUFnQixNQUFqQyxFQUF5QyxHQUF6QyxFQUErQztBQUM3QyxjQUFNLE9BQU0sV0FBVyxJQUFYLENBQWdCLENBQWhCLENBQVo7O0FBRUEsY0FBSyxLQUFLLEdBQUwsQ0FBVSxJQUFWLElBQWtCLElBQWxCLElBQTBCLENBQUMsUUFBaEMsRUFBMkM7QUFDekMsZ0JBQUssbUJBQWtCLENBQWxCLENBQUwsRUFBK0I7QUFDN0Isc0JBQVMsQ0FBVDtBQUNFLHFCQUFLLEtBQUssR0FBVjtBQUFlO0FBQ2Isd0JBQUssT0FBTSxDQUFYLEVBQWU7QUFDYiw2QkFBTyxJQUFQO0FBQ0QscUJBRkQsTUFFTztBQUNMLDZCQUFPLEtBQVA7QUFDRDtBQUNEO0FBQ0Q7QUFDRCxxQkFBSyxLQUFLLEdBQVY7QUFBZTtBQUNiLHdCQUFLLE9BQU0sQ0FBWCxFQUFlO0FBQ2IsNkJBQU8sRUFBUDtBQUNELHFCQUZELE1BRU87QUFDTCw2QkFBTyxJQUFQO0FBQ0Q7QUFDRDtBQUNEOztBQUVEO0FBbEJGO0FBb0JEO0FBQ0Y7O0FBRUQsY0FBSyxLQUFLLEdBQUwsQ0FBVSxJQUFWLElBQWtCLEdBQWxCLElBQXlCLFFBQTlCLEVBQXlDO0FBQ3ZDLGdCQUFNLGlCQUFpQixDQUF2QjtBQUNBLGdCQUFNLE9BQU8sUUFBUSxLQUFSLENBQWMsSUFBZCxDQUFtQixPQUFuQixDQUE0QixJQUE1QixFQUFrQyxFQUFsQyxJQUF5QyxDQUF0RDtBQUNBLGdCQUFNLE1BQU0sUUFBUSxLQUFSLENBQWMsR0FBZCxDQUFrQixPQUFsQixDQUEyQixJQUEzQixFQUFpQyxFQUFqQyxJQUF3QyxDQUFwRDtBQUNBLGdCQUFNLGlCQUFpQixTQUFqQixjQUFpQixDQUFFLE1BQUYsRUFBYztBQUFFLHFCQUFPLEtBQUssR0FBTCxDQUFVLEtBQUssR0FBTCxDQUFVLE1BQVYsRUFBa0IsQ0FBbEIsQ0FBVixFQUFpQyxPQUFPLFVBQXhDLENBQVA7QUFBOEQsYUFBckc7QUFDQSxvQkFBUyxDQUFUO0FBQ0UsbUJBQUssS0FBSyxHQUFWO0FBQWU7QUFDYixzQkFBTSxTQUFXLE9BQU0sQ0FBUixHQUFjLElBQTdCO0FBQ0EsMEJBQVEsS0FBUixDQUFjLElBQWQsR0FBd0IsZUFBZ0IsTUFBaEIsQ0FBeEI7QUFDQTtBQUNEO0FBQ0QsbUJBQUssS0FBSyxHQUFWO0FBQWU7QUFDYixzQkFBTSxVQUFXLE9BQU0sQ0FBUixHQUFjLEdBQTdCO0FBQ0EsMEJBQVEsS0FBUixDQUFjLEdBQWQsR0FBdUIsZUFBZ0IsT0FBaEIsQ0FBdkI7QUFDQTtBQUNEO0FBQ0QsbUJBQUssS0FBSyxHQUFWO0FBQWU7QUFDYixzQkFBTSxXQUFXLE9BQU0sY0FBUixHQUEyQixJQUExQztBQUNBLDBCQUFRLEtBQVIsQ0FBYyxJQUFkLEdBQXdCLGVBQWdCLFFBQWhCLENBQXhCO0FBQ0E7QUFDRDtBQUNELG1CQUFLLEtBQUssR0FBVjtBQUFlO0FBQ2Isc0JBQU0sV0FBVyxPQUFNLGNBQVIsR0FBMkIsR0FBMUM7QUFDQSwwQkFBUSxLQUFSLENBQWMsR0FBZCxHQUF1QixlQUFnQixRQUFoQixDQUF2QjtBQUNBO0FBQ0Q7O0FBRUQ7QUF0QkY7QUF3QkQ7QUFDRjtBQUNGO0FBQ0Y7O0FBRUQsMEJBQXVCLFlBQXZCO0FBQ0Q7O0FBRUQsV0FBUyxjQUFULENBQXlCLENBQXpCLEVBQTZCO0FBQzNCLGVBQVksRUFBRSxPQUFkO0FBQ0Q7O0FBRUQsV0FBUyxhQUFULENBQXdCLE9BQXhCLEVBQWtDO0FBQ2hDLFdBQU8sWUFBWSxRQUFRLEtBQXBCLENBQVA7QUFDRDs7QUFFRCxXQUFTLGlCQUFULENBQTRCLENBQTVCLEVBQWdDO0FBQzlCLGtCQUFlLEVBQUUsT0FBakI7QUFDRDs7QUFFRCxTQUFPLGdCQUFQLENBQXlCLGtCQUF6QixFQUE2QyxjQUE3QztBQUNBLFNBQU8sZ0JBQVAsQ0FBeUIscUJBQXpCLEVBQWdELGlCQUFoRDs7QUFFQSxNQUFLLENBQUMsVUFBTixFQUFtQjtBQUNqQixnQkFBYSxZQUFiLEVBQTJCLEdBQTNCO0FBQ0Q7QUFDRixDQXpPRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIoICgpID0+IHtcbiAgY29uc3QgaGF2ZUV2ZW50cyA9IFwib25nYW1lcGFkY29ubmVjdGVkXCIgaW4gd2luZG93O1xuICBjb25zdCBjb250cm9sbGVycyA9IHt9O1xuICBsZXQgY29vbGRvd25lZEJ1dHRvbnMgPSBbXTtcblxuICBjb25zdCBCVVRUT04gPSB7XG4gICAgQTogMCxcbiAgICBCOiAxLFxuICAgIFg6IDIsXG4gICAgWTogMyxcbiAgICBMQjogNCxcbiAgICBSQjogNSxcbiAgICBMVDogNixcbiAgICBSVDogNyxcbiAgICBCQUNLOiA4LFxuICAgIFNUQVJUOiA5LFxuICAgIExFRlRTVElDSzogMTAsXG4gICAgUklHSFRTVElDSzogMTEsXG4gICAgRFVQOiAxMixcbiAgICBERE9XTjogMTMsXG4gICAgRExFRlQ6IDE0LFxuICAgIERSSUdIVDogMTUsXG4gIH07XG5cbiAgY29uc3QgQVhJUyA9IHtcbiAgICBMT1g6IDAsXG4gICAgTE9ZOiAxLFxuICAgIFJPWDogMixcbiAgICBST1k6IDMsXG4gIH07XG5cbiAgbGV0IHBvaW50aW5nID0gZmFsc2U7XG4gIGNvbnN0IHBvaW50ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImRpdlwiICk7XG4gIHBvaW50ZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gIHBvaW50ZXIuc3R5bGUud2lkdGggPSBcIjFweFwiO1xuICBwb2ludGVyLnN0eWxlLmhlaWdodCA9IFwiMXB4XCI7XG4gIHBvaW50ZXIuc3R5bGUuYm94U2hhZG93ID0gXCIwIDAgN3B4IDRweCAjZjAwXCI7XG4gIHBvaW50ZXIuc3R5bGUuYmFja2dyb3VuZCA9IFwiI2YwMFwiO1xuICBwb2ludGVyLnN0eWxlLnRvcCA9IDA7XG4gIHBvaW50ZXIuc3R5bGUubGVmdCA9IDA7XG4gIHBvaW50ZXIuc3R5bGUuekluZGV4ID0gOTk7XG4gIHBvaW50ZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gXCI1MCVcIjtcbiAgcG9pbnRlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHBvaW50ZXIgKTtcblxuICBmdW5jdGlvbiBjb29sZG93biggYiApIHtcbiAgICBpZiAoIGNvb2xkb3duZWRCdXR0b25zLmluZGV4T2YoIGIgKSA8IDAgKSB7XG4gICAgICBjb29sZG93bmVkQnV0dG9ucy5wdXNoKCBiICk7XG5cbiAgICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICAgY29vbGRvd25lZEJ1dHRvbnMgPSBjb29sZG93bmVkQnV0dG9ucy5maWx0ZXIoICggdiApID0+IHsgcmV0dXJuICggdiAhPT0gYiApOyB9ICk7XG4gICAgICB9LCA1MDAgKTtcblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkZ2FtZXBhZCggZ2FtZXBhZCApIHtcbiAgICBjb250cm9sbGVyc1tnYW1lcGFkLmluZGV4XSA9IGdhbWVwYWQ7XG5cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHVwZGF0ZVN0YXR1cyApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIH1cblxuICBmdW5jdGlvbiBzY2FuZ2FtZXBhZHMoKSB7XG4gICAgY29uc3QgZ2FtZXBhZHMgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKSA6ICggbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzID8gbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKCkgOiBbXSApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5lc3RlZC10ZXJuYXJ5XG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgZ2FtZXBhZHMubGVuZ3RoOyBpKysgKSB7XG4gICAgICBpZiAoIGdhbWVwYWRzW2ldICkge1xuICAgICAgICBpZiAoIGdhbWVwYWRzW2ldLmluZGV4IGluIGNvbnRyb2xsZXJzICkge1xuICAgICAgICAgIGNvbnRyb2xsZXJzW2dhbWVwYWRzW2ldLmluZGV4XSA9IGdhbWVwYWRzW2ldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZGdhbWVwYWQoIGdhbWVwYWRzW2ldICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7XG4gICAgbGV0IGkgPSAwO1xuICAgIGxldCBqO1xuXG4gICAgaWYgKCAhaGF2ZUV2ZW50cyApIHtcbiAgICAgIHNjYW5nYW1lcGFkcygpO1xuICAgIH1cblxuICAgIGZvciAoIGogaW4gY29udHJvbGxlcnMgKSB7XG4gICAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCggY29udHJvbGxlcnMsIGogKSApIHtcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzW2pdO1xuXG4gICAgICAgIGZvciAoIGkgPSAwOyBpIDwgY29udHJvbGxlci5idXR0b25zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgIGNvbnN0IHZhbCA9IGNvbnRyb2xsZXIuYnV0dG9uc1tpXTtcbiAgICAgICAgICBsZXQgcHJlc3NlZDtcblxuICAgICAgICAgIGlmICggdHlwZW9mICggdmFsICkgPT09IFwib2JqZWN0XCIgKSB7XG4gICAgICAgICAgICBwcmVzc2VkID0gdmFsLnByZXNzZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCBwcmVzc2VkICYmIGNvb2xkb3duKCBgYnV0dG9uLSR7aX1gICkgKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKCBpICkge1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5BOlxuICAgICAgICAgICAgICAgIGlmICggUmV2ZWFsLmlzT3ZlcnZpZXcoKSApIHtcbiAgICAgICAgICAgICAgICAgIFJldmVhbC50b2dnbGVPdmVydmlldygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBSZXZlYWwubmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uQjpcbiAgICAgICAgICAgICAgICBSZXZlYWwucHJldigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5MQjpcbiAgICAgICAgICAgICAgICBSZXZlYWwucHJldigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5SQjpcbiAgICAgICAgICAgICAgICBSZXZlYWwubmV4dCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5MVDpcbiAgICAgICAgICAgICAgICBSZXZlYWwubGVmdCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5SVDpcbiAgICAgICAgICAgICAgICBSZXZlYWwucmlnaHQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uQkFDSzpcbiAgICAgICAgICAgICAgICBSZXZlYWwudG9nZ2xlUGF1c2UoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uU1RBUlQ6XG4gICAgICAgICAgICAgICAgUmV2ZWFsLnRvZ2dsZU92ZXJ2aWV3KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLkRVUDpcbiAgICAgICAgICAgICAgICBSZXZlYWwudXAoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uRERPV046XG4gICAgICAgICAgICAgICAgUmV2ZWFsLmRvd24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uRExFRlQ6XG4gICAgICAgICAgICAgICAgUmV2ZWFsLmxlZnQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uRFJJR0hUOlxuICAgICAgICAgICAgICAgIFJldmVhbC5yaWdodCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5SSUdIVFNUSUNLOlxuICAgICAgICAgICAgICAgIHBvaW50aW5nID0gIXBvaW50aW5nO1xuICAgICAgICAgICAgICAgIHBvaW50ZXIuc3R5bGUuZGlzcGxheSA9IHBvaW50aW5nID8gXCJibG9ja1wiIDogXCJub25lXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGkgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKCBpID0gMDsgaSA8IGNvbnRyb2xsZXIuYXhlcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICBjb25zdCB2YWwgPSBjb250cm9sbGVyLmF4ZXNbaV07XG5cbiAgICAgICAgICBpZiAoIE1hdGguYWJzKCB2YWwgKSA+IDAuODUgJiYgIXBvaW50aW5nICkge1xuICAgICAgICAgICAgaWYgKCBjb29sZG93biggYGF4aXMtJHtpfWAgKSApIHtcbiAgICAgICAgICAgICAgc3dpdGNoICggaSApIHtcbiAgICAgICAgICAgICAgICBjYXNlIEFYSVMuTE9YOiB7XG4gICAgICAgICAgICAgICAgICBpZiAoIHZhbCA8IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIFJldmVhbC5sZWZ0KCk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBSZXZlYWwucmlnaHQoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEFYSVMuTE9ZOiB7XG4gICAgICAgICAgICAgICAgICBpZiAoIHZhbCA8IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIFJldmVhbC51cCgpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgUmV2ZWFsLmRvd24oKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIG5vIGRlZmF1bHRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICggTWF0aC5hYnMoIHZhbCApID4gMC4yICYmIHBvaW50aW5nICkge1xuICAgICAgICAgICAgY29uc3QgZmFzdE11bHRpcGxpZXIgPSA4O1xuICAgICAgICAgICAgY29uc3QgbGVmdCA9IHBvaW50ZXIuc3R5bGUubGVmdC5yZXBsYWNlKCBcInB4XCIsIFwiXCIgKSAqIDE7XG4gICAgICAgICAgICBjb25zdCB0b3AgPSBwb2ludGVyLnN0eWxlLnRvcC5yZXBsYWNlKCBcInB4XCIsIFwiXCIgKSAqIDE7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJhaW5WYWx1ZSA9ICggbmV3VmFsICkgPT4geyByZXR1cm4gTWF0aC5taW4oIE1hdGgubWF4KCBuZXdWYWwsIDAgKSwgd2luZG93LmlubmVyV2lkdGggKTsgfTtcbiAgICAgICAgICAgIHN3aXRjaCAoIGkgKSB7XG4gICAgICAgICAgICAgIGNhc2UgQVhJUy5ST1g6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWwgPSAoIHZhbCAqIDIgKSArIGxlZnQ7XG4gICAgICAgICAgICAgICAgcG9pbnRlci5zdHlsZS5sZWZ0ID0gYCR7Y29uc3RyYWluVmFsdWUoIG5ld1ZhbCApfXB4YDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjYXNlIEFYSVMuUk9ZOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsID0gKCB2YWwgKiAyICkgKyB0b3A7XG4gICAgICAgICAgICAgICAgcG9pbnRlci5zdHlsZS50b3AgPSBgJHtjb25zdHJhaW5WYWx1ZSggbmV3VmFsICl9cHhgO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgQVhJUy5MT1g6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWwgPSAoIHZhbCAqIGZhc3RNdWx0aXBsaWVyICkgKyBsZWZ0O1xuICAgICAgICAgICAgICAgIHBvaW50ZXIuc3R5bGUubGVmdCA9IGAke2NvbnN0cmFpblZhbHVlKCBuZXdWYWwgKX1weGA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY2FzZSBBWElTLkxPWToge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbCA9ICggdmFsICogZmFzdE11bHRpcGxpZXIgKSArIHRvcDtcbiAgICAgICAgICAgICAgICBwb2ludGVyLnN0eWxlLnRvcCA9IGAke2NvbnN0cmFpblZhbHVlKCBuZXdWYWwgKX1weGA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBubyBkZWZhdWx0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCB1cGRhdGVTdGF0dXMgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbm5lY3RoYW5kbGVyKCBlICkge1xuICAgIGFkZGdhbWVwYWQoIGUuZ2FtZXBhZCApO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlZ2FtZXBhZCggZ2FtZXBhZCApIHtcbiAgICBkZWxldGUgY29udHJvbGxlcnNbZ2FtZXBhZC5pbmRleF07XG4gIH1cblxuICBmdW5jdGlvbiBkaXNjb25uZWN0aGFuZGxlciggZSApIHtcbiAgICByZW1vdmVnYW1lcGFkKCBlLmdhbWVwYWQgKTtcbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCBcImdhbWVwYWRjb25uZWN0ZWRcIiwgY29ubmVjdGhhbmRsZXIgKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIFwiZ2FtZXBhZGRpc2Nvbm5lY3RlZFwiLCBkaXNjb25uZWN0aGFuZGxlciApO1xuXG4gIGlmICggIWhhdmVFdmVudHMgKSB7XG4gICAgc2V0SW50ZXJ2YWwoIHNjYW5nYW1lcGFkcywgNTAwICk7XG4gIH1cbn0gKSgpO1xuIl19"}