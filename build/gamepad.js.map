{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/gamepad.js"],"names":[],"mappings":"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","file":"gamepad.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","( () => {\r\n  const haveEvents = \"ongamepadconnected\" in window;\r\n  const controllers = {};\r\n  let cooldownedButtons = [];\r\n\r\n  const BUTTON = {\r\n    A: 0,\r\n    B: 1,\r\n    X: 2,\r\n    Y: 3,\r\n    LB: 4,\r\n    RB: 5,\r\n    LT: 6,\r\n    RT: 7,\r\n    BACK: 8,\r\n    START: 9,\r\n    LEFTSTICK: 10,\r\n    RIGHTSTICK: 11,\r\n    DUP: 12,\r\n    DDOWN: 13,\r\n    DLEFT: 14,\r\n    DRIGHT: 15,\r\n  };\r\n\r\n  const AXIS = {\r\n    LOX: 0,\r\n    LOY: 1,\r\n    ROX: 2,\r\n    ROY: 3,\r\n  };\r\n\r\n  let pointing = false;\r\n  const pointer = document.createElement( \"div\" );\r\n  pointer.style.position = \"absolute\";\r\n  pointer.style.width = \"1px\";\r\n  pointer.style.height = \"1px\";\r\n  pointer.style.boxShadow = \"0 0 7px 4px #f00\";\r\n  pointer.style.background = \"#f00\";\r\n  pointer.style.top = 0;\r\n  pointer.style.left = 0;\r\n  pointer.style.zIndex = 99;\r\n  pointer.style.borderRadius = \"50%\";\r\n  pointer.style.display = \"none\";\r\n  document.body.appendChild( pointer );\r\n\r\n  function cooldown( b ) {\r\n    if ( cooldownedButtons.indexOf( b ) < 0 ) {\r\n      cooldownedButtons.push( b );\r\n\r\n      setTimeout( () => {\r\n        cooldownedButtons = cooldownedButtons.filter( ( v ) => { return ( v !== b ); } );\r\n      }, 250 );\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function addgamepad( gamepad ) {\r\n    controllers[gamepad.index] = gamepad;\r\n\r\n    requestAnimationFrame( updateStatus ); // eslint-disable-line\r\n  }\r\n\r\n  function scangamepads() {\r\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : ( navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : [] ); // eslint-disable-line no-nested-ternary\r\n    for ( let i = 0; i < gamepads.length; i++ ) {\r\n      if ( gamepads[i] ) {\r\n        if ( gamepads[i].index in controllers ) {\r\n          controllers[gamepads[i].index] = gamepads[i];\r\n        } else {\r\n          addgamepad( gamepads[i] );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateStatus() {\r\n    let i = 0;\r\n    let j;\r\n\r\n    if ( !haveEvents ) {\r\n      scangamepads();\r\n    }\r\n\r\n    for ( j in controllers ) {\r\n      if ( Object.prototype.hasOwnProperty.call( controllers, j ) ) {\r\n        const controller = controllers[j];\r\n\r\n        for ( i = 0; i < controller.buttons.length; i++ ) {\r\n          const val = controller.buttons[i];\r\n          let pressed;\r\n\r\n          if ( typeof ( val ) === \"object\" ) {\r\n            pressed = val.pressed;\r\n          }\r\n\r\n          if ( pressed && cooldown( `button-${i}` ) ) {\r\n            switch ( i ) {\r\n              case BUTTON.A:\r\n                if ( Reveal.isOverview() ) {\r\n                  Reveal.toggleOverview();\r\n                } else {\r\n                  Reveal.next();\r\n                }\r\n                break;\r\n              case BUTTON.B:\r\n                Reveal.prev();\r\n                break;\r\n              case BUTTON.LB:\r\n                Reveal.prev();\r\n                break;\r\n              case BUTTON.RB:\r\n                Reveal.next();\r\n                break;\r\n              case BUTTON.LT:\r\n                Reveal.left();\r\n                break;\r\n              case BUTTON.RT:\r\n                Reveal.right();\r\n                break;\r\n              case BUTTON.BACK:\r\n                Reveal.togglePause();\r\n                break;\r\n              case BUTTON.START:\r\n                Reveal.toggleOverview();\r\n                break;\r\n              case BUTTON.DUP:\r\n                Reveal.up();\r\n                break;\r\n              case BUTTON.DDOWN:\r\n                Reveal.down();\r\n                break;\r\n              case BUTTON.DLEFT:\r\n                Reveal.left();\r\n                break;\r\n              case BUTTON.DRIGHT:\r\n                Reveal.right();\r\n                break;\r\n              case BUTTON.RIGHTSTICK:\r\n                pointing = !pointing;\r\n                pointer.style.display = pointing ? \"block\" : \"none\";\r\n                break;\r\n              default:\r\n                console.log( i );\r\n            }\r\n          }\r\n        }\r\n\r\n        for ( i = 0; i < controller.axes.length; i++ ) {\r\n          const val = controller.axes[i];\r\n\r\n          if ( Math.abs( val ) > 0.85 && !pointing ) {\r\n            if ( cooldown( `axis-${i}` ) ) {\r\n              switch ( i ) {\r\n                case AXIS.LOX: {\r\n                  if ( val < 0 ) {\r\n                    Reveal.left();\r\n                  } else {\r\n                    Reveal.right();\r\n                  }\r\n                  break;\r\n                }\r\n                case AXIS.LOY: {\r\n                  if ( val < 0 ) {\r\n                    Reveal.up();\r\n                  } else {\r\n                    Reveal.down();\r\n                  }\r\n                  break;\r\n                }\r\n\r\n                // no default\r\n              }\r\n            }\r\n          }\r\n\r\n          if ( Math.abs( val ) > 0.2 && pointing ) {\r\n            const fastMultiplier = 8;\r\n            const left = pointer.style.left.replace( \"px\", \"\" ) * 1;\r\n            const top = pointer.style.top.replace( \"px\", \"\" ) * 1;\r\n            const constrainValue = ( newVal ) => { return Math.min( Math.max( newVal, 0 ), window.innerWidth ); };\r\n            switch ( i ) {\r\n              case AXIS.ROX: {\r\n                const newVal = ( val * 2 ) + left;\r\n                pointer.style.left = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.ROY: {\r\n                const newVal = ( val * 2 ) + top;\r\n                pointer.style.top = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.LOX: {\r\n                const newVal = ( val * fastMultiplier ) + left;\r\n                pointer.style.left = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.LOY: {\r\n                const newVal = ( val * fastMultiplier ) + top;\r\n                pointer.style.top = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n\r\n              // no default\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    requestAnimationFrame( updateStatus );\r\n  }\r\n\r\n  function connecthandler( e ) {\r\n    addgamepad( e.gamepad );\r\n  }\r\n\r\n  function removegamepad( gamepad ) {\r\n    delete controllers[gamepad.index];\r\n  }\r\n\r\n  function disconnecthandler( e ) {\r\n    removegamepad( e.gamepad );\r\n  }\r\n\r\n  window.addEventListener( \"gamepadconnected\", connecthandler );\r\n  window.addEventListener( \"gamepaddisconnected\", disconnecthandler );\r\n\r\n  if ( !haveEvents ) {\r\n    setInterval( scangamepads, 500 );\r\n  }\r\n} )();\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGdhbWVwYWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDQUEsQ0FBRSxZQUFNO0FBQ04sTUFBTSxhQUFhLHdCQUF3QixNQUEzQztBQUNBLE1BQU0sY0FBYyxFQUFwQjtBQUNBLE1BQUksb0JBQW9CLEVBQXhCOztBQUVBLE1BQU0sU0FBUztBQUNiLE9BQUcsQ0FEVTtBQUViLE9BQUcsQ0FGVTtBQUdiLE9BQUcsQ0FIVTtBQUliLE9BQUcsQ0FKVTtBQUtiLFFBQUksQ0FMUztBQU1iLFFBQUksQ0FOUztBQU9iLFFBQUksQ0FQUztBQVFiLFFBQUksQ0FSUztBQVNiLFVBQU0sQ0FUTztBQVViLFdBQU8sQ0FWTTtBQVdiLGVBQVcsRUFYRTtBQVliLGdCQUFZLEVBWkM7QUFhYixTQUFLLEVBYlE7QUFjYixXQUFPLEVBZE07QUFlYixXQUFPLEVBZk07QUFnQmIsWUFBUTtBQWhCSyxHQUFmOztBQW1CQSxNQUFNLE9BQU87QUFDWCxTQUFLLENBRE07QUFFWCxTQUFLLENBRk07QUFHWCxTQUFLLENBSE07QUFJWCxTQUFLO0FBSk0sR0FBYjs7QUFPQSxNQUFJLFdBQVcsS0FBZjtBQUNBLE1BQU0sVUFBVSxTQUFTLGFBQVQsQ0FBd0IsS0FBeEIsQ0FBaEI7QUFDQSxVQUFRLEtBQVIsQ0FBYyxRQUFkLEdBQXlCLFVBQXpCO0FBQ0EsVUFBUSxLQUFSLENBQWMsS0FBZCxHQUFzQixLQUF0QjtBQUNBLFVBQVEsS0FBUixDQUFjLE1BQWQsR0FBdUIsS0FBdkI7QUFDQSxVQUFRLEtBQVIsQ0FBYyxTQUFkLEdBQTBCLGtCQUExQjtBQUNBLFVBQVEsS0FBUixDQUFjLFVBQWQsR0FBMkIsTUFBM0I7QUFDQSxVQUFRLEtBQVIsQ0FBYyxHQUFkLEdBQW9CLENBQXBCO0FBQ0EsVUFBUSxLQUFSLENBQWMsSUFBZCxHQUFxQixDQUFyQjtBQUNBLFVBQVEsS0FBUixDQUFjLE1BQWQsR0FB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QUF5QixDQUF6QixFQUE2QjtBQUMzQixlQUFZLEVBQUUsT0FBZDtBQUNEOztBQUVELFdBQVMsYUFBVCxDQUF3QixPQUF4QixFQUFrQztBQUNoQyxXQUFPLFlBQVksUUFBUSxLQUFwQixDQUFQO0FBQ0Q7O0FBRUQsV0FBUyxpQkFBVCxDQUE0QixDQUE1QixFQUFnQztBQUM5QixrQkFBZSxFQUFFLE9BQWpCO0FBQ0Q7O0FBRUQsU0FBTyxnQkFBUCxDQUF5QixrQkFBekIsRUFBNkMsY0FBN0M7QUFDQSxTQUFPLGdCQUFQLENBQXlCLHFCQUF6QixFQUFnRCxpQkFBaEQ7O0FBRUEsTUFBSyxDQUFDLFVBQU4sRUFBbUI7QUFDakIsZ0JBQWEsWUFBYixFQUEyQixHQUEzQjtBQUNEO0FBQ0YsQ0F6T0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiKCAoKSA9PiB7XHJcbiAgY29uc3QgaGF2ZUV2ZW50cyA9IFwib25nYW1lcGFkY29ubmVjdGVkXCIgaW4gd2luZG93O1xyXG4gIGNvbnN0IGNvbnRyb2xsZXJzID0ge307XHJcbiAgbGV0IGNvb2xkb3duZWRCdXR0b25zID0gW107XHJcblxyXG4gIGNvbnN0IEJVVFRPTiA9IHtcclxuICAgIEE6IDAsXHJcbiAgICBCOiAxLFxyXG4gICAgWDogMixcclxuICAgIFk6IDMsXHJcbiAgICBMQjogNCxcclxuICAgIFJCOiA1LFxyXG4gICAgTFQ6IDYsXHJcbiAgICBSVDogNyxcclxuICAgIEJBQ0s6IDgsXHJcbiAgICBTVEFSVDogOSxcclxuICAgIExFRlRTVElDSzogMTAsXHJcbiAgICBSSUdIVFNUSUNLOiAxMSxcclxuICAgIERVUDogMTIsXHJcbiAgICBERE9XTjogMTMsXHJcbiAgICBETEVGVDogMTQsXHJcbiAgICBEUklHSFQ6IDE1LFxyXG4gIH07XHJcblxyXG4gIGNvbnN0IEFYSVMgPSB7XHJcbiAgICBMT1g6IDAsXHJcbiAgICBMT1k6IDEsXHJcbiAgICBST1g6IDIsXHJcbiAgICBST1k6IDMsXHJcbiAgfTtcclxuXHJcbiAgbGV0IHBvaW50aW5nID0gZmFsc2U7XHJcbiAgY29uc3QgcG9pbnRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKTtcclxuICBwb2ludGVyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4gIHBvaW50ZXIuc3R5bGUud2lkdGggPSBcIjFweFwiO1xyXG4gIHBvaW50ZXIuc3R5bGUuaGVpZ2h0ID0gXCIxcHhcIjtcclxuICBwb2ludGVyLnN0eWxlLmJveFNoYWRvdyA9IFwiMCAwIDdweCA0cHggI2YwMFwiO1xyXG4gIHBvaW50ZXIuc3R5bGUuYmFja2dyb3VuZCA9IFwiI2YwMFwiO1xyXG4gIHBvaW50ZXIuc3R5bGUudG9wID0gMDtcclxuICBwb2ludGVyLnN0eWxlLmxlZnQgPSAwO1xyXG4gIHBvaW50ZXIuc3R5bGUuekluZGV4ID0gOTk7XHJcbiAgcG9pbnRlci5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjUwJVwiO1xyXG4gIHBvaW50ZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHBvaW50ZXIgKTtcclxuXHJcbiAgZnVuY3Rpb24gY29vbGRvd24oIGIgKSB7XHJcbiAgICBpZiAoIGNvb2xkb3duZWRCdXR0b25zLmluZGV4T2YoIGIgKSA8IDAgKSB7XHJcbiAgICAgIGNvb2xkb3duZWRCdXR0b25zLnB1c2goIGIgKTtcclxuXHJcbiAgICAgIHNldFRpbWVvdXQoICgpID0+IHtcclxuICAgICAgICBjb29sZG93bmVkQnV0dG9ucyA9IGNvb2xkb3duZWRCdXR0b25zLmZpbHRlciggKCB2ICkgPT4geyByZXR1cm4gKCB2ICE9PSBiICk7IH0gKTtcclxuICAgICAgfSwgMjUwICk7XHJcblxyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGRnYW1lcGFkKCBnYW1lcGFkICkge1xyXG4gICAgY29udHJvbGxlcnNbZ2FtZXBhZC5pbmRleF0gPSBnYW1lcGFkO1xyXG5cclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSggdXBkYXRlU3RhdHVzICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNjYW5nYW1lcGFkcygpIHtcclxuICAgIGNvbnN0IGdhbWVwYWRzID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzID8gbmF2aWdhdG9yLmdldEdhbWVwYWRzKCkgOiAoIG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcyA/IG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcygpIDogW10gKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXN0ZWQtdGVybmFyeVxyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgZ2FtZXBhZHMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGlmICggZ2FtZXBhZHNbaV0gKSB7XHJcbiAgICAgICAgaWYgKCBnYW1lcGFkc1tpXS5pbmRleCBpbiBjb250cm9sbGVycyApIHtcclxuICAgICAgICAgIGNvbnRyb2xsZXJzW2dhbWVwYWRzW2ldLmluZGV4XSA9IGdhbWVwYWRzW2ldO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhZGRnYW1lcGFkKCBnYW1lcGFkc1tpXSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xyXG4gICAgbGV0IGkgPSAwO1xyXG4gICAgbGV0IGo7XHJcblxyXG4gICAgaWYgKCAhaGF2ZUV2ZW50cyApIHtcclxuICAgICAgc2NhbmdhbWVwYWRzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yICggaiBpbiBjb250cm9sbGVycyApIHtcclxuICAgICAgaWYgKCBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoIGNvbnRyb2xsZXJzLCBqICkgKSB7XHJcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzW2pdO1xyXG5cclxuICAgICAgICBmb3IgKCBpID0gMDsgaSA8IGNvbnRyb2xsZXIuYnV0dG9ucy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgIGNvbnN0IHZhbCA9IGNvbnRyb2xsZXIuYnV0dG9uc1tpXTtcclxuICAgICAgICAgIGxldCBwcmVzc2VkO1xyXG5cclxuICAgICAgICAgIGlmICggdHlwZW9mICggdmFsICkgPT09IFwib2JqZWN0XCIgKSB7XHJcbiAgICAgICAgICAgIHByZXNzZWQgPSB2YWwucHJlc3NlZDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoIHByZXNzZWQgJiYgY29vbGRvd24oIGBidXR0b24tJHtpfWAgKSApIHtcclxuICAgICAgICAgICAgc3dpdGNoICggaSApIHtcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5BOlxyXG4gICAgICAgICAgICAgICAgaWYgKCBSZXZlYWwuaXNPdmVydmlldygpICkge1xyXG4gICAgICAgICAgICAgICAgICBSZXZlYWwudG9nZ2xlT3ZlcnZpZXcoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIFJldmVhbC5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5COlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLnByZXYoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLkxCOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLnByZXYoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLlJCOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLm5leHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLkxUOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLmxlZnQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLlJUOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLnJpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5CQUNLOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLnRvZ2dsZVBhdXNlKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5TVEFSVDpcclxuICAgICAgICAgICAgICAgIFJldmVhbC50b2dnbGVPdmVydmlldygpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgY2FzZSBCVVRUT04uRFVQOlxyXG4gICAgICAgICAgICAgICAgUmV2ZWFsLnVwKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5ERE9XTjpcclxuICAgICAgICAgICAgICAgIFJldmVhbC5kb3duKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5ETEVGVDpcclxuICAgICAgICAgICAgICAgIFJldmVhbC5sZWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlIEJVVFRPTi5EUklHSFQ6XHJcbiAgICAgICAgICAgICAgICBSZXZlYWwucmlnaHQoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgQlVUVE9OLlJJR0hUU1RJQ0s6XHJcbiAgICAgICAgICAgICAgICBwb2ludGluZyA9ICFwb2ludGluZztcclxuICAgICAgICAgICAgICAgIHBvaW50ZXIuc3R5bGUuZGlzcGxheSA9IHBvaW50aW5nID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coIGkgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICggaSA9IDA7IGkgPCBjb250cm9sbGVyLmF4ZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICBjb25zdCB2YWwgPSBjb250cm9sbGVyLmF4ZXNbaV07XHJcblxyXG4gICAgICAgICAgaWYgKCBNYXRoLmFicyggdmFsICkgPiAwLjg1ICYmICFwb2ludGluZyApIHtcclxuICAgICAgICAgICAgaWYgKCBjb29sZG93biggYGF4aXMtJHtpfWAgKSApIHtcclxuICAgICAgICAgICAgICBzd2l0Y2ggKCBpICkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBBWElTLkxPWDoge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoIHZhbCA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgUmV2ZWFsLmxlZnQoKTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBSZXZlYWwucmlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhc2UgQVhJUy5MT1k6IHtcclxuICAgICAgICAgICAgICAgICAgaWYgKCB2YWwgPCAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIFJldmVhbC51cCgpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIFJldmVhbC5kb3duKCk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbm8gZGVmYXVsdFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmICggTWF0aC5hYnMoIHZhbCApID4gMC4yICYmIHBvaW50aW5nICkge1xyXG4gICAgICAgICAgICBjb25zdCBmYXN0TXVsdGlwbGllciA9IDg7XHJcbiAgICAgICAgICAgIGNvbnN0IGxlZnQgPSBwb2ludGVyLnN0eWxlLmxlZnQucmVwbGFjZSggXCJweFwiLCBcIlwiICkgKiAxO1xyXG4gICAgICAgICAgICBjb25zdCB0b3AgPSBwb2ludGVyLnN0eWxlLnRvcC5yZXBsYWNlKCBcInB4XCIsIFwiXCIgKSAqIDE7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnN0cmFpblZhbHVlID0gKCBuZXdWYWwgKSA9PiB7IHJldHVybiBNYXRoLm1pbiggTWF0aC5tYXgoIG5ld1ZhbCwgMCApLCB3aW5kb3cuaW5uZXJXaWR0aCApOyB9O1xyXG4gICAgICAgICAgICBzd2l0Y2ggKCBpICkge1xyXG4gICAgICAgICAgICAgIGNhc2UgQVhJUy5ST1g6IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbCA9ICggdmFsICogMiApICsgbGVmdDtcclxuICAgICAgICAgICAgICAgIHBvaW50ZXIuc3R5bGUubGVmdCA9IGAke2NvbnN0cmFpblZhbHVlKCBuZXdWYWwgKX1weGA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgY2FzZSBBWElTLlJPWToge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsID0gKCB2YWwgKiAyICkgKyB0b3A7XHJcbiAgICAgICAgICAgICAgICBwb2ludGVyLnN0eWxlLnRvcCA9IGAke2NvbnN0cmFpblZhbHVlKCBuZXdWYWwgKX1weGA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgY2FzZSBBWElTLkxPWDoge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsID0gKCB2YWwgKiBmYXN0TXVsdGlwbGllciApICsgbGVmdDtcclxuICAgICAgICAgICAgICAgIHBvaW50ZXIuc3R5bGUubGVmdCA9IGAke2NvbnN0cmFpblZhbHVlKCBuZXdWYWwgKX1weGA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgY2FzZSBBWElTLkxPWToge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsID0gKCB2YWwgKiBmYXN0TXVsdGlwbGllciApICsgdG9wO1xyXG4gICAgICAgICAgICAgICAgcG9pbnRlci5zdHlsZS50b3AgPSBgJHtjb25zdHJhaW5WYWx1ZSggbmV3VmFsICl9cHhgO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBubyBkZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHVwZGF0ZVN0YXR1cyApO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY29ubmVjdGhhbmRsZXIoIGUgKSB7XHJcbiAgICBhZGRnYW1lcGFkKCBlLmdhbWVwYWQgKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbW92ZWdhbWVwYWQoIGdhbWVwYWQgKSB7XHJcbiAgICBkZWxldGUgY29udHJvbGxlcnNbZ2FtZXBhZC5pbmRleF07XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkaXNjb25uZWN0aGFuZGxlciggZSApIHtcclxuICAgIHJlbW92ZWdhbWVwYWQoIGUuZ2FtZXBhZCApO1xyXG4gIH1cclxuXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIFwiZ2FtZXBhZGNvbm5lY3RlZFwiLCBjb25uZWN0aGFuZGxlciApO1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCBcImdhbWVwYWRkaXNjb25uZWN0ZWRcIiwgZGlzY29ubmVjdGhhbmRsZXIgKTtcclxuXHJcbiAgaWYgKCAhaGF2ZUV2ZW50cyApIHtcclxuICAgIHNldEludGVydmFsKCBzY2FuZ2FtZXBhZHMsIDUwMCApO1xyXG4gIH1cclxufSApKCk7XHJcbiJdfQ=="}