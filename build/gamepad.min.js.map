{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/gamepad.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","cooldown","b","cooldownedButtons","indexOf","push","setTimeout","filter","v","addgamepad","gamepad","controllers","index","requestAnimationFrame","updateStatus","scangamepads","gamepads","navigator","getGamepads","webkitGetGamepads","j","haveEvents","Object","prototype","hasOwnProperty","controller","buttons","val","pressed","_typeof","BUTTON","A","Reveal","isOverview","toggleOverview","next","B","LB","prev","RB","LT","left","RT","right","BACK","togglePause","START","DUP","up","DDOWN","down","DLEFT","DRIGHT","RIGHTSTICK","pointing","pointer","style","display","axes","_val","Math","abs","AXIS","LOX","LOY","replace","top","constrainValue","newVal","min","max","window","innerWidth","ROX","ROY","_newVal","_newVal2","_newVal3","connecthandler","removegamepad","disconnecthandler","X","Y","LEFTSTICK","document","createElement","position","width","height","boxShadow","background","zIndex","borderRadius","body","appendChild","addEventListener","setInterval"],"mappings":"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","file":"gamepad.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","( () => {\r\n  const haveEvents = \"ongamepadconnected\" in window;\r\n  const controllers = {};\r\n  let cooldownedButtons = [];\r\n\r\n  const BUTTON = {\r\n    A: 0,\r\n    B: 1,\r\n    X: 2,\r\n    Y: 3,\r\n    LB: 4,\r\n    RB: 5,\r\n    LT: 6,\r\n    RT: 7,\r\n    BACK: 8,\r\n    START: 9,\r\n    LEFTSTICK: 10,\r\n    RIGHTSTICK: 11,\r\n    DUP: 12,\r\n    DDOWN: 13,\r\n    DLEFT: 14,\r\n    DRIGHT: 15,\r\n  };\r\n\r\n  const AXIS = {\r\n    LOX: 0,\r\n    LOY: 1,\r\n    ROX: 2,\r\n    ROY: 3,\r\n  };\r\n\r\n  let pointing = false;\r\n  const pointer = document.createElement( \"div\" );\r\n  pointer.style.position = \"absolute\";\r\n  pointer.style.width = \"1px\";\r\n  pointer.style.height = \"1px\";\r\n  pointer.style.boxShadow = \"0 0 7px 4px #f00\";\r\n  pointer.style.background = \"#f00\";\r\n  pointer.style.top = 0;\r\n  pointer.style.left = 0;\r\n  pointer.style.zIndex = 99;\r\n  pointer.style.borderRadius = \"50%\";\r\n  pointer.style.display = \"none\";\r\n  document.body.appendChild( pointer );\r\n\r\n  function cooldown( b ) {\r\n    if ( cooldownedButtons.indexOf( b ) < 0 ) {\r\n      cooldownedButtons.push( b );\r\n\r\n      setTimeout( () => {\r\n        cooldownedButtons = cooldownedButtons.filter( ( v ) => { return ( v !== b ); } );\r\n      }, 250 );\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function addgamepad( gamepad ) {\r\n    controllers[gamepad.index] = gamepad;\r\n\r\n    requestAnimationFrame( updateStatus ); // eslint-disable-line\r\n  }\r\n\r\n  function scangamepads() {\r\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : ( navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : [] ); // eslint-disable-line no-nested-ternary\r\n    for ( let i = 0; i < gamepads.length; i++ ) {\r\n      if ( gamepads[i] ) {\r\n        if ( gamepads[i].index in controllers ) {\r\n          controllers[gamepads[i].index] = gamepads[i];\r\n        } else {\r\n          addgamepad( gamepads[i] );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateStatus() {\r\n    let i = 0;\r\n    let j;\r\n\r\n    if ( !haveEvents ) {\r\n      scangamepads();\r\n    }\r\n\r\n    for ( j in controllers ) {\r\n      if ( Object.prototype.hasOwnProperty.call( controllers, j ) ) {\r\n        const controller = controllers[j];\r\n\r\n        for ( i = 0; i < controller.buttons.length; i++ ) {\r\n          const val = controller.buttons[i];\r\n          let pressed;\r\n\r\n          if ( typeof ( val ) === \"object\" ) {\r\n            pressed = val.pressed;\r\n          }\r\n\r\n          if ( pressed && cooldown( `button-${i}` ) ) {\r\n            switch ( i ) {\r\n              case BUTTON.A:\r\n                if ( Reveal.isOverview() ) {\r\n                  Reveal.toggleOverview();\r\n                } else {\r\n                  Reveal.next();\r\n                }\r\n                break;\r\n              case BUTTON.B:\r\n                Reveal.prev();\r\n                break;\r\n              case BUTTON.LB:\r\n                Reveal.prev();\r\n                break;\r\n              case BUTTON.RB:\r\n                Reveal.next();\r\n                break;\r\n              case BUTTON.LT:\r\n                Reveal.left();\r\n                break;\r\n              case BUTTON.RT:\r\n                Reveal.right();\r\n                break;\r\n              case BUTTON.BACK:\r\n                Reveal.togglePause();\r\n                break;\r\n              case BUTTON.START:\r\n                Reveal.toggleOverview();\r\n                break;\r\n              case BUTTON.DUP:\r\n                Reveal.up();\r\n                break;\r\n              case BUTTON.DDOWN:\r\n                Reveal.down();\r\n                break;\r\n              case BUTTON.DLEFT:\r\n                Reveal.left();\r\n                break;\r\n              case BUTTON.DRIGHT:\r\n                Reveal.right();\r\n                break;\r\n              case BUTTON.RIGHTSTICK:\r\n                pointing = !pointing;\r\n                pointer.style.display = pointing ? \"block\" : \"none\";\r\n                break;\r\n              default:\r\n                console.log( i );\r\n            }\r\n          }\r\n        }\r\n\r\n        for ( i = 0; i < controller.axes.length; i++ ) {\r\n          const val = controller.axes[i];\r\n\r\n          if ( Math.abs( val ) > 0.85 && !pointing ) {\r\n            if ( cooldown( `axis-${i}` ) ) {\r\n              switch ( i ) {\r\n                case AXIS.LOX: {\r\n                  if ( val < 0 ) {\r\n                    Reveal.left();\r\n                  } else {\r\n                    Reveal.right();\r\n                  }\r\n                  break;\r\n                }\r\n                case AXIS.LOY: {\r\n                  if ( val < 0 ) {\r\n                    Reveal.up();\r\n                  } else {\r\n                    Reveal.down();\r\n                  }\r\n                  break;\r\n                }\r\n\r\n                // no default\r\n              }\r\n            }\r\n          }\r\n\r\n          if ( Math.abs( val ) > 0.2 && pointing ) {\r\n            const fastMultiplier = 8;\r\n            const left = pointer.style.left.replace( \"px\", \"\" ) * 1;\r\n            const top = pointer.style.top.replace( \"px\", \"\" ) * 1;\r\n            const constrainValue = ( newVal ) => { return Math.min( Math.max( newVal, 0 ), window.innerWidth ); };\r\n            switch ( i ) {\r\n              case AXIS.ROX: {\r\n                const newVal = ( val * 2 ) + left;\r\n                pointer.style.left = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.ROY: {\r\n                const newVal = ( val * 2 ) + top;\r\n                pointer.style.top = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.LOX: {\r\n                const newVal = ( val * fastMultiplier ) + left;\r\n                pointer.style.left = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n              case AXIS.LOY: {\r\n                const newVal = ( val * fastMultiplier ) + top;\r\n                pointer.style.top = `${constrainValue( newVal )}px`;\r\n                break;\r\n              }\r\n\r\n              // no default\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    requestAnimationFrame( updateStatus );\r\n  }\r\n\r\n  function connecthandler( e ) {\r\n    addgamepad( e.gamepad );\r\n  }\r\n\r\n  function removegamepad( gamepad ) {\r\n    delete controllers[gamepad.index];\r\n  }\r\n\r\n  function disconnecthandler( e ) {\r\n    removegamepad( e.gamepad );\r\n  }\r\n\r\n  window.addEventListener( \"gamepadconnected\", connecthandler );\r\n  window.addEventListener( \"gamepaddisconnected\", disconnecthandler );\r\n\r\n  if ( !haveEvents ) {\r\n    setInterval( scangamepads, 500 );\r\n  }\r\n} )();\r\n"]}