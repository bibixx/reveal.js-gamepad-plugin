{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/gamepad.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","cooldown","b","cooldownedButtons","indexOf","push","setTimeout","filter","v","addgamepad","gamepad","controllers","index","requestAnimationFrame","updateStatus","scangamepads","gamepads","navigator","getGamepads","webkitGetGamepads","j","haveEvents","Object","prototype","hasOwnProperty","controller","buttons","val","pressed","_typeof","BUTTON","A","Reveal","isOverview","toggleOverview","next","B","LB","prev","RB","LT","left","RT","right","BACK","togglePause","START","DUP","up","DDOWN","down","DLEFT","DRIGHT","RIGHTSTICK","pointing","pointer","style","display","axes","_val","Math","abs","AXIS","LOX","LOY","replace","top","constrainValue","newVal","min","max","window","innerWidth","ROX","ROY","_newVal","_newVal2","_newVal3","connecthandler","removegamepad","disconnecthandler","X","Y","LEFTSTICK","document","createElement","position","width","height","boxShadow","background","zIndex","borderRadius","body","appendChild","addEventListener","setInterval"],"mappings":"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","file":"gamepad.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","( () => {\n  const haveEvents = \"ongamepadconnected\" in window;\n  const controllers = {};\n  let cooldownedButtons = [];\n\n  const BUTTON = {\n    A: 0,\n    B: 1,\n    X: 2,\n    Y: 3,\n    LB: 4,\n    RB: 5,\n    LT: 6,\n    RT: 7,\n    BACK: 8,\n    START: 9,\n    LEFTSTICK: 10,\n    RIGHTSTICK: 11,\n    DUP: 12,\n    DDOWN: 13,\n    DLEFT: 14,\n    DRIGHT: 15,\n  };\n\n  const AXIS = {\n    LOX: 0,\n    LOY: 1,\n    ROX: 2,\n    ROY: 3,\n  };\n\n  let pointing = false;\n  const pointer = document.createElement( \"div\" );\n  pointer.style.position = \"absolute\";\n  pointer.style.width = \"1px\";\n  pointer.style.height = \"1px\";\n  pointer.style.boxShadow = \"0 0 7px 4px #f00\";\n  pointer.style.background = \"#f00\";\n  pointer.style.top = 0;\n  pointer.style.left = 0;\n  pointer.style.zIndex = 99;\n  pointer.style.borderRadius = \"50%\";\n  pointer.style.display = \"none\";\n  document.body.appendChild( pointer );\n\n  function cooldown( b ) {\n    if ( cooldownedButtons.indexOf( b ) < 0 ) {\n      cooldownedButtons.push( b );\n\n      setTimeout( () => {\n        cooldownedButtons = cooldownedButtons.filter( ( v ) => { return ( v !== b ); } );\n      }, 500 );\n\n      return true;\n    }\n\n    return false;\n  }\n\n  function addgamepad( gamepad ) {\n    controllers[gamepad.index] = gamepad;\n\n    requestAnimationFrame( updateStatus ); // eslint-disable-line\n  }\n\n  function scangamepads() {\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : ( navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : [] ); // eslint-disable-line no-nested-ternary\n    for ( let i = 0; i < gamepads.length; i++ ) {\n      if ( gamepads[i] ) {\n        if ( gamepads[i].index in controllers ) {\n          controllers[gamepads[i].index] = gamepads[i];\n        } else {\n          addgamepad( gamepads[i] );\n        }\n      }\n    }\n  }\n\n  function updateStatus() {\n    let i = 0;\n    let j;\n\n    if ( !haveEvents ) {\n      scangamepads();\n    }\n\n    for ( j in controllers ) {\n      if ( Object.prototype.hasOwnProperty.call( controllers, j ) ) {\n        const controller = controllers[j];\n\n        for ( i = 0; i < controller.buttons.length; i++ ) {\n          const val = controller.buttons[i];\n          let pressed;\n\n          if ( typeof ( val ) === \"object\" ) {\n            pressed = val.pressed;\n          }\n\n          if ( pressed && cooldown( `button-${i}` ) ) {\n            switch ( i ) {\n              case BUTTON.A:\n                if ( Reveal.isOverview() ) {\n                  Reveal.toggleOverview();\n                } else {\n                  Reveal.next();\n                }\n                break;\n              case BUTTON.B:\n                Reveal.prev();\n                break;\n              case BUTTON.LB:\n                Reveal.prev();\n                break;\n              case BUTTON.RB:\n                Reveal.next();\n                break;\n              case BUTTON.LT:\n                Reveal.left();\n                break;\n              case BUTTON.RT:\n                Reveal.right();\n                break;\n              case BUTTON.BACK:\n                Reveal.togglePause();\n                break;\n              case BUTTON.START:\n                Reveal.toggleOverview();\n                break;\n              case BUTTON.DUP:\n                Reveal.up();\n                break;\n              case BUTTON.DDOWN:\n                Reveal.down();\n                break;\n              case BUTTON.DLEFT:\n                Reveal.left();\n                break;\n              case BUTTON.DRIGHT:\n                Reveal.right();\n                break;\n              case BUTTON.RIGHTSTICK:\n                pointing = !pointing;\n                pointer.style.display = pointing ? \"block\" : \"none\";\n                break;\n              default:\n                console.log( i );\n            }\n          }\n        }\n\n        for ( i = 0; i < controller.axes.length; i++ ) {\n          const val = controller.axes[i];\n\n          if ( Math.abs( val ) > 0.85 && !pointing ) {\n            if ( cooldown( `axis-${i}` ) ) {\n              switch ( i ) {\n                case AXIS.LOX: {\n                  if ( val < 0 ) {\n                    Reveal.left();\n                  } else {\n                    Reveal.right();\n                  }\n                  break;\n                }\n                case AXIS.LOY: {\n                  if ( val < 0 ) {\n                    Reveal.up();\n                  } else {\n                    Reveal.down();\n                  }\n                  break;\n                }\n\n                // no default\n              }\n            }\n          }\n\n          if ( Math.abs( val ) > 0.2 && pointing ) {\n            const fastMultiplier = 8;\n            const left = pointer.style.left.replace( \"px\", \"\" ) * 1;\n            const top = pointer.style.top.replace( \"px\", \"\" ) * 1;\n            const constrainValue = ( newVal ) => { return Math.min( Math.max( newVal, 0 ), window.innerWidth ); };\n            switch ( i ) {\n              case AXIS.ROX: {\n                const newVal = ( val * 2 ) + left;\n                pointer.style.left = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.ROY: {\n                const newVal = ( val * 2 ) + top;\n                pointer.style.top = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.LOX: {\n                const newVal = ( val * fastMultiplier ) + left;\n                pointer.style.left = `${constrainValue( newVal )}px`;\n                break;\n              }\n              case AXIS.LOY: {\n                const newVal = ( val * fastMultiplier ) + top;\n                pointer.style.top = `${constrainValue( newVal )}px`;\n                break;\n              }\n\n              // no default\n            }\n          }\n        }\n      }\n    }\n\n    requestAnimationFrame( updateStatus );\n  }\n\n  function connecthandler( e ) {\n    addgamepad( e.gamepad );\n  }\n\n  function removegamepad( gamepad ) {\n    delete controllers[gamepad.index];\n  }\n\n  function disconnecthandler( e ) {\n    removegamepad( e.gamepad );\n  }\n\n  window.addEventListener( \"gamepadconnected\", connecthandler );\n  window.addEventListener( \"gamepaddisconnected\", disconnecthandler );\n\n  if ( !haveEvents ) {\n    setInterval( scangamepads, 500 );\n  }\n} )();\n"]}